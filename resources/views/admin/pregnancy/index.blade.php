<x-app-layout>
    <x-slot name="header">
        {{ __('Pengingat kehamilan') }}
    </x-slot>

    <div class="p-4 bg-white rounded-lg shadow-xs">
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            @foreach ($users as $user)
                @php
                    $agePregnancy = get_age_of_pregnancy($user->age_pregnancy ? $user->age_pregnancy->pregnancy_start : 0);
                @endphp
                <div class="bg-white space-y-3 rounded-lg shadow-md p-4 relative">
                    @if (get_miseed_pregnnacy($alerts, $user->pregnancy_statuses, $agePregnancy))
                    <span class="bg-red-100 absolute right-1 top-1 text-red-800 text-xs font-semibold mr-2 px-2.5 py-0.5 rounded dark:bg-red-200 dark:text-red-900">
                        miss {{ get_miseed_pregnnacy($alerts, $user->pregnancy_statuses, $agePregnancy) }}
                    </span>
                    @else
                    <span class="bg-blue-100 absolute right-1 top-1  text-blue-800 text-xs font-semibold mr-2 px-2.5 py-0.5 rounded dark:bg-blue-200 dark:text-blue-800">no miss</span>
                    @endif
                    <div class="flex flex-rox justify-start">
                        <svg width="40" height="40" viewBox="0 0 40 40" fill="none"
                            xmlns="http://www.w3.org/2000/svg">
                            <path
                                d="M25.62 20.56C26.886 19.2005 27.5991 17.4175 27.62 15.56C27.62 13.555 26.8235 11.632 25.4057 10.2143C23.988 8.7965 22.065 8 20.06 8C18.055 8 16.132 8.7965 14.7143 10.2143C13.2965 11.632 12.5 13.555 12.5 15.56C12.5209 17.4175 13.234 19.2005 14.5 20.56C12.7373 21.4377 11.2204 22.7399 10.0858 24.3493C8.95122 25.9587 8.23445 27.8249 8 29.78C7.94165 30.3104 8.09641 30.8423 8.43022 31.2587C8.76404 31.675 9.24957 31.9417 9.78 32C10.3104 32.0583 10.8423 31.9036 11.2586 31.5698C11.675 31.236 11.9417 30.7504 12 30.22C12.2387 28.2823 13.1777 26.4987 14.6402 25.2053C16.1027 23.9119 17.9876 23.198 19.94 23.198C21.8924 23.198 23.7773 23.9119 25.2398 25.2053C26.7023 26.4987 27.6413 28.2823 27.88 30.22C27.9356 30.7328 28.1872 31.2043 28.5823 31.536C28.9773 31.8677 29.4853 32.034 30 32H30.22C30.7443 31.9397 31.2235 31.6746 31.5531 31.2625C31.8828 30.8504 32.0362 30.3247 31.98 29.8C31.7629 27.8552 31.0688 25.9941 29.9592 24.3821C28.8497 22.7701 27.3591 21.4572 25.62 20.56V20.56ZM20 19.12C19.2959 19.12 18.6076 18.9112 18.0222 18.52C17.4367 18.1289 16.9804 17.5729 16.711 16.9224C16.4415 16.2718 16.371 15.5561 16.5084 14.8655C16.6458 14.1749 16.9848 13.5406 17.4827 13.0427C17.9806 12.5448 18.6149 12.2058 19.3055 12.0684C19.9961 11.931 20.7118 12.0015 21.3624 12.271C22.0129 12.5404 22.5689 12.9967 22.96 13.5822C23.3512 14.1676 23.56 14.8559 23.56 15.56C23.56 16.5042 23.1849 17.4097 22.5173 18.0773C21.8497 18.7449 20.9442 19.12 20 19.12V19.12ZM34 0H6C4.4087 0 2.88258 0.632141 1.75736 1.75736C0.632141 2.88258 0 4.4087 0 6V34C0 35.5913 0.632141 37.1174 1.75736 38.2426C2.88258 39.3679 4.4087 40 6 40H34C35.5913 40 37.1174 39.3679 38.2426 38.2426C39.3679 37.1174 40 35.5913 40 34V6C40 4.4087 39.3679 2.88258 38.2426 1.75736C37.1174 0.632141 35.5913 0 34 0ZM36 34C36 34.5304 35.7893 35.0391 35.4142 35.4142C35.0391 35.7893 34.5304 36 34 36H6C5.46957 36 4.96086 35.7893 4.58579 35.4142C4.21071 35.0391 4 34.5304 4 34V6C4 5.46957 4.21071 4.96086 4.58579 4.58579C4.96086 4.21071 5.46957 4 6 4H34C34.5304 4 35.0391 4.21071 35.4142 4.58579C35.7893 4.96086 36 5.46957 36 6V34Z"
                                fill="#262727" />
                        </svg>
                        <div class="ml-3">
                            {{-- name --}}
                            <h5 class="text-base font-medium text-dark">{{ $user->name }}</h5>
                            {{-- email --}}
                            <p class="text-user-xs font-normal text-dark">{{ $user->email }}</p>
                        </div>
                    </div>
                    <div class="flex flex-col space-y-1">
                        {{-- umur berdasarkan minggu --}}
                        <h6 class="text-xs font-semibold text-dark">Minggu {{ $agePregnancy }}<span class="text-dark-gray">/42</span>
                        </h6>
                        <div class="flex flex-row w-full items-center">
                            <div class="w-full bg-gray-200 rounded-full h-1.5 dark:bg-gray-700">
                                {{-- progress bar --}}
                                <div class="bg-primary-index h-1.5 rounded-full"
                                    style="width: {{ ($agePregnancy / 42) * 100 }}%">
                                </div>
                            </div>
                        </div>
                    </div>
                    <hr>
                    <div class="flex flex-col space-y-2 h-[141px] max-h-[141px] overflow-y-auto scrollbar">
                        @foreach ($alerts as $alert)
                            @php
                                // Cek apakah alert ada di status alert user?
                                $alertAndStatus = get_alert_in_statuses($alert->id, $user->pregnancy_statuses);
                            @endphp
                            @if ($alertAndStatus) {{-- jika ada maka ditampilihn warna hijau --}}
                                <div class="flex flex-row items-center justify-start">
                                    <div class="w-[24px] h-[24px]">
                                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none"
                                            xmlns="http://www.w3.org/2000/svg">
                                            <path
                                                d="M18.7099 7.21C18.617 7.11627 18.5064 7.04188 18.3845 6.99111C18.2627 6.94034 18.132 6.9142 17.9999 6.9142C17.8679 6.9142 17.7372 6.94034 17.6154 6.99111C17.4935 7.04188 17.3829 7.11627 17.29 7.21L9.83995 14.67L6.70995 11.53C6.61343 11.4368 6.49949 11.3634 6.37463 11.3142C6.24978 11.265 6.11645 11.2409 5.98227 11.2432C5.84809 11.2456 5.71568 11.2743 5.5926 11.3278C5.46953 11.3813 5.35819 11.4585 5.26495 11.555C5.17171 11.6515 5.0984 11.7655 5.04919 11.8903C4.99999 12.0152 4.97586 12.1485 4.97818 12.2827C4.9805 12.4169 5.00923 12.5493 5.06272 12.6723C5.11622 12.7954 5.19343 12.9068 5.28995 13L9.12995 16.84C9.22291 16.9337 9.33351 17.0081 9.45537 17.0589C9.57723 17.1097 9.70794 17.1358 9.83995 17.1358C9.97196 17.1358 10.1027 17.1097 10.2245 17.0589C10.3464 17.0081 10.457 16.9337 10.55 16.84L18.7099 8.68C18.8115 8.58636 18.8925 8.4727 18.9479 8.3462C19.0033 8.21971 19.0319 8.0831 19.0319 7.945C19.0319 7.8069 19.0033 7.67029 18.9479 7.54379C18.8925 7.41729 18.8115 7.30364 18.7099 7.21Z"
                                                fill="#066F6A" />
                                        </svg>
                                    </div>
                                    <span class="text-user-xs text-primary-index leading-4">{{ $alert->title }}</span>
                                </div>
                            @else 
                            {{-- jika tidak ada maka dicek apakah alert tersebut udah kelewat dengan umur kehamilan atau belum --}}
                            @if ($agePregnancy > $alert->weeks) {{-- jika kelewat maka ditampilin warna merah --}}
                            <div class="flex flex-row items-center justify-start">
                                <div class="h-[24px] w-[24px] flex justify-center items-center">
                                    <svg width="11" height="11" viewBox="0 0 11 11" fill="none"
                                        xmlns="http://www.w3.org/2000/svg">
                                        <path
                                            d="M6.46867 5.49941L10.7968 1.17771C10.9262 1.04833 10.9988 0.872856 10.9988 0.689887C10.9988 0.506917 10.9262 0.331442 10.7968 0.202063C10.6674 0.0726843 10.492 0 10.309 0C10.1261 0 9.95061 0.0726843 9.82124 0.202063L5.5 4.53064L1.17876 0.202063C1.04939 0.0726843 0.873935 1.62448e-07 0.690986 1.63812e-07C0.508036 1.65175e-07 0.332579 0.0726843 0.203214 0.202063C0.073849 0.331442 0.0011726 0.506917 0.0011726 0.689887C0.0011726 0.872856 0.073849 1.04833 0.203214 1.17771L4.53133 5.49941L0.203214 9.82112C0.138822 9.88499 0.0877136 9.96098 0.0528354 10.0447C0.0179572 10.1284 0 10.2182 0 10.3089C0 10.3996 0.0179572 10.4894 0.0528354 10.5732C0.0877136 10.6569 0.138822 10.7329 0.203214 10.7968C0.26708 10.8612 0.343063 10.9123 0.42678 10.9472C0.510498 10.982 0.600293 11 0.690986 11C0.781678 11 0.871473 10.982 0.955191 10.9472C1.03891 10.9123 1.11489 10.8612 1.17876 10.7968L5.5 6.46819L9.82124 10.7968C9.88511 10.8612 9.96109 10.9123 10.0448 10.9472C10.1285 10.982 10.2183 11 10.309 11C10.3997 11 10.4895 10.982 10.5732 10.9472C10.6569 10.9123 10.7329 10.8612 10.7968 10.7968C10.8612 10.7329 10.9123 10.6569 10.9472 10.5732C10.982 10.4894 11 10.3996 11 10.3089C11 10.2182 10.982 10.1284 10.9472 10.0447C10.9123 9.96098 10.8612 9.88499 10.7968 9.82112L6.46867 5.49941Z"
                                            fill="#EC3347" />
                                    </svg>
                                </div>
                                <span class="text-user-xs text-red-500">{{ $alert->title }}</span>
                            </div>
                            @else
                                {{-- jika belum kelewat dicek lagi nih, apakah sesuai dengan umur sekarang --}}
                                @if ($agePregnancy == $alert->weeks) {{-- jika iya maka ditampilin umur sekarang --}}
                                <div class="flex flex-row items-center justify-start">
                                    <div class="h-[24px] w-[24px] flex justify-center items-center">
                                        <svg width="13" height="13" viewBox="0 0 13 13" fill="none" xmlns="http://www.w3.org/2000/svg">
                                            <path d="M10.2872 11.3761H9.74556V10.4731C9.74388 10.1632 9.68899 9.85577 9.5833 9.56436C9.57738 9.54846 9.57117 9.53371 9.56386 9.51857C9.47613 9.27938 9.35494 9.05383 9.2039 8.84866L8.44562 7.83727C8.23523 7.55552 8.12124 7.21347 8.12056 6.86184V6.31486C8.1218 5.8842 8.29277 5.47138 8.59638 5.16594L8.95237 4.80994C9.366 4.39407 9.6317 3.85395 9.7087 3.27248C9.709 3.26495 9.71304 3.25867 9.71304 3.25106L9.71152 3.24362C9.73035 3.12829 9.74172 3.01186 9.74557 2.89507V1.62609H10.2872C10.4309 1.62609 10.5687 1.56902 10.6703 1.46744C10.7718 1.36586 10.8289 1.22808 10.8289 1.08442C10.8289 0.940763 10.7718 0.802988 10.6703 0.701406C10.5687 0.599823 10.4309 0.542755 10.2872 0.542755H2.7039C2.56024 0.542755 2.42247 0.599823 2.32089 0.701406C2.21931 0.802988 2.16224 0.940763 2.16224 1.08442C2.16224 1.22808 2.21931 1.36586 2.32089 1.46744C2.42247 1.56902 2.56024 1.62609 2.7039 1.62609H3.24557V2.89507C3.24942 3.01186 3.26079 3.12829 3.27962 3.24362L3.2781 3.25109C3.2781 3.25867 3.28213 3.26498 3.28243 3.27251C3.35943 3.85398 3.62514 4.3941 4.03876 4.80997L4.39476 5.16597C4.69836 5.4714 4.86932 5.88421 4.87056 6.31486V6.86184C4.86986 7.21342 4.75598 7.55543 4.54578 7.83726L3.78697 8.84864C3.63597 9.05391 3.51481 9.27953 3.4271 9.51878C3.41989 9.53379 3.41371 9.54837 3.40786 9.5641C3.30216 9.8556 3.24726 10.1631 3.24556 10.4731V11.3761H2.7039C2.56024 11.3761 2.42246 11.4332 2.32088 11.5347C2.2193 11.6363 2.16223 11.7741 2.16223 11.9178C2.16223 12.0614 2.2193 12.1992 2.32088 12.3008C2.42246 12.4024 2.56024 12.4594 2.7039 12.4594H10.2872C10.4309 12.4594 10.5687 12.4024 10.6702 12.3008C10.7718 12.1992 10.8289 12.0614 10.8289 11.9178C10.8289 11.7741 10.7718 11.6363 10.6702 11.5347C10.5687 11.4332 10.4309 11.3761 10.2872 11.3761V11.3761ZM4.3289 2.70942V1.62609H8.66223V2.70942H4.3289ZM4.80471 4.04402C4.72838 3.96734 4.65999 3.88316 4.60056 3.79275H8.39057C8.33114 3.88316 8.26274 3.96734 8.18642 4.04402L7.83042 4.40002C7.4079 4.82005 7.13698 5.36861 7.06024 5.95942H5.93087C5.85415 5.36859 5.58323 4.82001 5.1607 4.39996L4.80471 4.04402ZM5.4125 8.48684C5.72592 8.06687 5.91176 7.56554 5.94782 7.04275H7.04331C7.07934 7.56559 7.26529 8.06696 7.5789 8.48684L8.12063 9.20942H4.87036L5.4125 8.48684ZM8.66223 11.3761H4.3289V10.4731C4.33041 10.4128 4.33533 10.3526 4.34364 10.2928H8.64749C8.6558 10.3526 8.66072 10.4128 8.66223 10.4731V11.3761Z" fill="#262727"/>
                                            </svg>                                
                                    </div>
                                    <span class="text-user-xs text-dark">{{ $alert->title }}</span>
                                </div>
                                @endif
                                {{-- Jika tidak juga berarti dia belum saatnya ditampilin --}}
                            @endif
                            @endif
                        @endforeach
                    </div>
                </div>
            @endforeach
        </div>
    </div>
    <script>
        const scrollEl =document.querySelectorAll('.scrollbar')

        scrollEl.forEach(scroll => {
            scroll.scrollTop = scroll.scrollHeight;
        });
    </script>
</x-app-layout>

{{-- <div class="flex flex-row items-center justify-start">
    <div class="w-[24px] h-[24px]">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none"
            xmlns="http://www.w3.org/2000/svg">
            <path
                d="M18.7099 7.21C18.617 7.11627 18.5064 7.04188 18.3845 6.99111C18.2627 6.94034 18.132 6.9142 17.9999 6.9142C17.8679 6.9142 17.7372 6.94034 17.6154 6.99111C17.4935 7.04188 17.3829 7.11627 17.29 7.21L9.83995 14.67L6.70995 11.53C6.61343 11.4368 6.49949 11.3634 6.37463 11.3142C6.24978 11.265 6.11645 11.2409 5.98227 11.2432C5.84809 11.2456 5.71568 11.2743 5.5926 11.3278C5.46953 11.3813 5.35819 11.4585 5.26495 11.555C5.17171 11.6515 5.0984 11.7655 5.04919 11.8903C4.99999 12.0152 4.97586 12.1485 4.97818 12.2827C4.9805 12.4169 5.00923 12.5493 5.06272 12.6723C5.11622 12.7954 5.19343 12.9068 5.28995 13L9.12995 16.84C9.22291 16.9337 9.33351 17.0081 9.45537 17.0589C9.57723 17.1097 9.70794 17.1358 9.83995 17.1358C9.97196 17.1358 10.1027 17.1097 10.2245 17.0589C10.3464 17.0081 10.457 16.9337 10.55 16.84L18.7099 8.68C18.8115 8.58636 18.8925 8.4727 18.9479 8.3462C19.0033 8.21971 19.0319 8.0831 19.0319 7.945C19.0319 7.8069 19.0033 7.67029 18.9479 7.54379C18.8925 7.41729 18.8115 7.30364 18.7099 7.21Z"
                fill="#066F6A" />
        </svg>
    </div>
    <span class="text-user-xs text-primary-index leading-4">Melakukan imunisasi di puskesmas
        terdekat dengan kondisi yang baik dan terkontrol oleh sistem yang baik dan aman</span>
</div>
<div class="flex flex-row items-center justify-start">
    <div class="h-[24px] w-[24px] flex justify-center items-center">
        <svg width="13" height="13" viewBox="0 0 13 13" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M10.2872 11.3761H9.74556V10.4731C9.74388 10.1632 9.68899 9.85577 9.5833 9.56436C9.57738 9.54846 9.57117 9.53371 9.56386 9.51857C9.47613 9.27938 9.35494 9.05383 9.2039 8.84866L8.44562 7.83727C8.23523 7.55552 8.12124 7.21347 8.12056 6.86184V6.31486C8.1218 5.8842 8.29277 5.47138 8.59638 5.16594L8.95237 4.80994C9.366 4.39407 9.6317 3.85395 9.7087 3.27248C9.709 3.26495 9.71304 3.25867 9.71304 3.25106L9.71152 3.24362C9.73035 3.12829 9.74172 3.01186 9.74557 2.89507V1.62609H10.2872C10.4309 1.62609 10.5687 1.56902 10.6703 1.46744C10.7718 1.36586 10.8289 1.22808 10.8289 1.08442C10.8289 0.940763 10.7718 0.802988 10.6703 0.701406C10.5687 0.599823 10.4309 0.542755 10.2872 0.542755H2.7039C2.56024 0.542755 2.42247 0.599823 2.32089 0.701406C2.21931 0.802988 2.16224 0.940763 2.16224 1.08442C2.16224 1.22808 2.21931 1.36586 2.32089 1.46744C2.42247 1.56902 2.56024 1.62609 2.7039 1.62609H3.24557V2.89507C3.24942 3.01186 3.26079 3.12829 3.27962 3.24362L3.2781 3.25109C3.2781 3.25867 3.28213 3.26498 3.28243 3.27251C3.35943 3.85398 3.62514 4.3941 4.03876 4.80997L4.39476 5.16597C4.69836 5.4714 4.86932 5.88421 4.87056 6.31486V6.86184C4.86986 7.21342 4.75598 7.55543 4.54578 7.83726L3.78697 8.84864C3.63597 9.05391 3.51481 9.27953 3.4271 9.51878C3.41989 9.53379 3.41371 9.54837 3.40786 9.5641C3.30216 9.8556 3.24726 10.1631 3.24556 10.4731V11.3761H2.7039C2.56024 11.3761 2.42246 11.4332 2.32088 11.5347C2.2193 11.6363 2.16223 11.7741 2.16223 11.9178C2.16223 12.0614 2.2193 12.1992 2.32088 12.3008C2.42246 12.4024 2.56024 12.4594 2.7039 12.4594H10.2872C10.4309 12.4594 10.5687 12.4024 10.6702 12.3008C10.7718 12.1992 10.8289 12.0614 10.8289 11.9178C10.8289 11.7741 10.7718 11.6363 10.6702 11.5347C10.5687 11.4332 10.4309 11.3761 10.2872 11.3761V11.3761ZM4.3289 2.70942V1.62609H8.66223V2.70942H4.3289ZM4.80471 4.04402C4.72838 3.96734 4.65999 3.88316 4.60056 3.79275H8.39057C8.33114 3.88316 8.26274 3.96734 8.18642 4.04402L7.83042 4.40002C7.4079 4.82005 7.13698 5.36861 7.06024 5.95942H5.93087C5.85415 5.36859 5.58323 4.82001 5.1607 4.39996L4.80471 4.04402ZM5.4125 8.48684C5.72592 8.06687 5.91176 7.56554 5.94782 7.04275H7.04331C7.07934 7.56559 7.26529 8.06696 7.5789 8.48684L8.12063 9.20942H4.87036L5.4125 8.48684ZM8.66223 11.3761H4.3289V10.4731C4.33041 10.4128 4.33533 10.3526 4.34364 10.2928H8.64749C8.6558 10.3526 8.66072 10.4128 8.66223 10.4731V11.3761Z" fill="#262727"/>
            </svg>                                
    </div>
    <span class="text-user-xs text-dark">Melakukan imunisasi di puskesmas terdekat</span>
</div>
<div class="flex flex-row items-center justify-start">
    <div class="h-[24px] w-[24px] flex justify-center items-center">
        <svg width="11" height="11" viewBox="0 0 11 11" fill="none"
            xmlns="http://www.w3.org/2000/svg">
            <path
                d="M6.46867 5.49941L10.7968 1.17771C10.9262 1.04833 10.9988 0.872856 10.9988 0.689887C10.9988 0.506917 10.9262 0.331442 10.7968 0.202063C10.6674 0.0726843 10.492 0 10.309 0C10.1261 0 9.95061 0.0726843 9.82124 0.202063L5.5 4.53064L1.17876 0.202063C1.04939 0.0726843 0.873935 1.62448e-07 0.690986 1.63812e-07C0.508036 1.65175e-07 0.332579 0.0726843 0.203214 0.202063C0.073849 0.331442 0.0011726 0.506917 0.0011726 0.689887C0.0011726 0.872856 0.073849 1.04833 0.203214 1.17771L4.53133 5.49941L0.203214 9.82112C0.138822 9.88499 0.0877136 9.96098 0.0528354 10.0447C0.0179572 10.1284 0 10.2182 0 10.3089C0 10.3996 0.0179572 10.4894 0.0528354 10.5732C0.0877136 10.6569 0.138822 10.7329 0.203214 10.7968C0.26708 10.8612 0.343063 10.9123 0.42678 10.9472C0.510498 10.982 0.600293 11 0.690986 11C0.781678 11 0.871473 10.982 0.955191 10.9472C1.03891 10.9123 1.11489 10.8612 1.17876 10.7968L5.5 6.46819L9.82124 10.7968C9.88511 10.8612 9.96109 10.9123 10.0448 10.9472C10.1285 10.982 10.2183 11 10.309 11C10.3997 11 10.4895 10.982 10.5732 10.9472C10.6569 10.9123 10.7329 10.8612 10.7968 10.7968C10.8612 10.7329 10.9123 10.6569 10.9472 10.5732C10.982 10.4894 11 10.3996 11 10.3089C11 10.2182 10.982 10.1284 10.9472 10.0447C10.9123 9.96098 10.8612 9.88499 10.7968 9.82112L6.46867 5.49941Z"
                fill="#EC3347" />
        </svg>
    </div>
    <span class="text-user-xs text-red-500">Melakukan imunisasi di puskesmas terdekat</span>
</div> --}}
